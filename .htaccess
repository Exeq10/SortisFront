# ============================
# Redirección SPA (React/Vue/Angular)
# ============================
RewriteEngine On
RewriteBase /

# Si el archivo o directorio existe, servirlo
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Si no existe, redirigir siempre a index.html
RewriteRule . /index.html [L]

# ============================
# Cacheo inteligente para PWA
# ============================
<IfModule mod_expires.c>
  ExpiresActive On

  # Archivos estáticos (cache fuerte)
  ExpiresByType image/jpg "access plus 1 month"
  ExpiresByType image/jpeg "access plus 1 month"
  ExpiresByType image/png "access plus 1 month"
  ExpiresByType image/gif "access plus 1 month"
  ExpiresByType image/svg+xml "access plus 1 month"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"

  # HTML siempre actualizado
  ExpiresByType text/html "access plus 0 seconds"

  # Archivos críticos (no cachear nunca)
  <FilesMatch "(^service-worker\.js$|^manifest\.json$|^index\.html$)">
    ExpiresDefault "access plus 0 seconds"
    Header set Cache-Control "no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0"
  </FilesMatch>
</IfModule>

# ============================
# Forzar codificación
# ============================
AddDefaultCharset utf-8
